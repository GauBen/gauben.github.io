<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prism.js test : la matinée – Gautier Ben Aïm</title><meta name="description" content="Markdown syntax highlighting is fun!"><link rel="stylesheet" href="/index.7c6ae21f.css"><link rel="stylesheet" href="/blog/2021-05-12-async-and-await/index.be394964.css"><link rel="stylesheet" href="/blog/2021-05-18-prismjs-test-la-matinée/index.6d42f050.css"><link rel="icon shortcut" href="/favicon.5a116284.ico" type="image/x-icon"><link rel="manifest" href="/__/assets/app.webmanifest"><meta property="og:image" content="/portfolio.7b1b742e.png"></head><body> <h1 class="markdown-title">Prism.js test : la matinée</h1> <div class="markdown-body"> <p> Markdown syntax highlighting is fun!<br> 751 mots<br> May 18, 2021<br> TODO Auteur et tags </p> <pre class="language-js"><code class="language-js"><span class="keyword token">const</span> fs <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'fs'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> path <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'path'</span><span class="punctuation token">)</span><br><br><span class="keyword token">const</span> highlight <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'@11ty/eleventy-plugin-syntaxhighlight'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> rss <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'@11ty/eleventy-plugin-rss'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> <span class="punctuation token">{</span> DateTime <span class="punctuation token">}</span> <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'luxon'</span><span class="punctuation token">)</span><br><br><span class="keyword token">const</span> markdownIt <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'markdown-it'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> footnote <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'markdown-it-footnote'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> taskLists <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'markdown-it-task-lists'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> implicitFigures <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'markdown-it-implicit-figures'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> katex <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'@traptitech/markdown-it-katex'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> imageLazyLoading <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'markdown-it-image-lazy-loading'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> multimdTable <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'markdown-it-multimd-table'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> anchor <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'markdown-it-anchor'</span><span class="punctuation token">)</span><br><span class="keyword token">const</span> tocDoneRight <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'markdown-it-toc-done-right'</span><span class="punctuation token">)</span><br><br><span class="keyword token">const</span> locales <span class="operator token">=</span> <span class="function token">require</span><span class="punctuation token">(</span><span class="string token">'./locales.json'</span><span class="punctuation token">)</span><br><br><span class="keyword token">const</span> flattenObject <span class="operator token">=</span> <span class="punctuation token">(</span>obj<span class="punctuation token">,</span> out <span class="operator token">=</span> <span class="keyword token">new</span> <span class="class-name token">Map</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">,</span> prefix <span class="operator token">=</span> <span class="string token">''</span><span class="punctuation token">)</span> <span class="operator token">=></span> <span class="punctuation token">{</span><br>  <span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">const</span> <span class="punctuation token">[</span>key<span class="punctuation token">,</span> value<span class="punctuation token">]</span> <span class="keyword token">of</span> Object<span class="punctuation token">.</span><span class="function token">entries</span><span class="punctuation token">(</span>obj<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    <span class="keyword token">if</span> <span class="punctuation token">(</span>value <span class="keyword token">instanceof</span> <span class="class-name token">Object</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>      <span class="function token">flattenObject</span><span class="punctuation token">(</span>value<span class="punctuation token">,</span> out<span class="punctuation token">,</span> <span class="template-string token"><span class="string template-punctuation token">`</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>prefix<span class="interpolation-punctuation punctuation token">}</span></span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>key<span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">.</span><span class="string template-punctuation token">`</span></span><span class="punctuation token">)</span><br>    <span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="punctuation token">{</span><br>      out<span class="punctuation token">.</span><span class="function token">set</span><span class="punctuation token">(</span><span class="template-string token"><span class="string template-punctuation token">`</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>prefix<span class="interpolation-punctuation punctuation token">}</span></span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>key<span class="interpolation-punctuation punctuation token">}</span></span><span class="string template-punctuation token">`</span></span><span class="punctuation token">,</span> value<span class="punctuation token">)</span><br>    <span class="punctuation token">}</span><br>  <span class="punctuation token">}</span><br>  <span class="keyword token">return</span> out<br><span class="punctuation token">}</span><br><br>module<span class="punctuation token">.</span><span class="function function-variable token">exports</span> <span class="operator token">=</span> <span class="punctuation token">(</span><span class="parameter token">eleventyConfig</span><span class="punctuation token">)</span> <span class="operator token">=></span> <span class="punctuation token">{</span><br>  <span class="comment token">// Register locales</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addGlobalData</span><span class="punctuation token">(</span><span class="string token">'locales'</span><span class="punctuation token">,</span> locales<span class="punctuation token">)</span><br><br>  <span class="comment token">// Find translations</span><br>  <span class="keyword token">const</span> translations <span class="operator token">=</span> <span class="keyword token">new</span> <span class="class-name token">Map</span><span class="punctuation token">(</span><span class="punctuation token">)</span><br>  <span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">const</span> locale <span class="keyword token">of</span> Object<span class="punctuation token">.</span><span class="function token">keys</span><span class="punctuation token">(</span>locales<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    <span class="keyword token">if</span> <span class="punctuation token">(</span>locale <span class="operator token">===</span> <span class="string token">'index'</span><span class="punctuation token">)</span> <span class="keyword token">continue</span><br>    <span class="keyword token">const</span> strings <span class="operator token">=</span> <span class="constant token">JSON</span><span class="punctuation token">.</span><span class="function token">parse</span><span class="punctuation token">(</span><br>      fs<span class="punctuation token">.</span><span class="function token">readFileSync</span><span class="punctuation token">(</span><span class="template-string token"><span class="string template-punctuation token">`</span><span class="string token">./translations/</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>locale<span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">.json</span><span class="string template-punctuation token">`</span></span><span class="punctuation token">)</span><span class="punctuation token">.</span><span class="function token">toString</span><span class="punctuation token">(</span><span class="punctuation token">)</span><br>    <span class="punctuation token">)</span><br>    translations<span class="punctuation token">.</span><span class="function token">set</span><span class="punctuation token">(</span>locale<span class="punctuation token">,</span> <span class="function token">flattenObject</span><span class="punctuation token">(</span>strings<span class="punctuation token">)</span><span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><br>  <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="operator token">!</span>translations<span class="punctuation token">.</span><span class="function token">has</span><span class="punctuation token">(</span>locales<span class="punctuation token">.</span>index<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    <span class="keyword token">throw</span> <span class="keyword token">new</span> <span class="class-name token">Error</span><span class="punctuation token">(</span><br>      <span class="template-string token"><span class="string template-punctuation token">`</span><span class="string token">Main locale "</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>locales<span class="punctuation token">.</span>index<span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">" not found (./translations/</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>locales<span class="punctuation token">.</span>index<span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">.json)</span><span class="string template-punctuation token">`</span></span><br>    <span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><br><br>  <span class="comment token">// Add eleventy plugins</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addPlugin</span><span class="punctuation token">(</span>highlight<span class="punctuation token">)</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addPlugin</span><span class="punctuation token">(</span>rss<span class="punctuation token">)</span><br><br>  <span class="comment token">// Add many libraries to markdown-it</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">setLibrary</span><span class="punctuation token">(</span><br>    <span class="string token">'md'</span><span class="punctuation token">,</span><br>    <span class="function token">markdownIt</span><span class="punctuation token">(</span><span class="punctuation token">{</span> html<span class="operator token">:</span> <span class="boolean token">true</span><span class="punctuation token">,</span> linkify<span class="operator token">:</span> <span class="boolean token">true</span><span class="punctuation token">,</span> typographer<span class="operator token">:</span> <span class="boolean token">true</span> <span class="punctuation token">}</span><span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span>footnote<span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span>taskLists<span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span>multimdTable<span class="punctuation token">,</span> <span class="punctuation token">{</span><br>        multiline<span class="operator token">:</span> <span class="boolean token">true</span><span class="punctuation token">,</span><br>        rowspan<span class="operator token">:</span> <span class="boolean token">true</span><span class="punctuation token">,</span><br>        headerless<span class="operator token">:</span> <span class="boolean token">true</span><span class="punctuation token">,</span><br>      <span class="punctuation token">}</span><span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span>implicitFigures<span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span>katex<span class="punctuation token">,</span> <span class="punctuation token">{</span> throwOnError<span class="operator token">:</span> <span class="boolean token">true</span> <span class="punctuation token">}</span><span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span>imageLazyLoading<span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span>anchor<span class="punctuation token">,</span> <span class="punctuation token">{</span><br>        level<span class="operator token">:</span> <span class="number token">2</span><span class="punctuation token">,</span><br>        permalink<span class="operator token">:</span> <span class="boolean token">true</span><span class="punctuation token">,</span><br>        permalinkSymbol<span class="operator token">:</span> <span class="string token">'#'</span><span class="punctuation token">,</span><br>        permalinkBefore<span class="operator token">:</span> <span class="boolean token">true</span><span class="punctuation token">,</span><br>      <span class="punctuation token">}</span><span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span>tocDoneRight<span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">use</span><span class="punctuation token">(</span><span class="punctuation token">(</span><span class="parameter token">md</span><span class="punctuation token">)</span> <span class="operator token">=></span> <span class="punctuation token">{</span><br>        <span class="keyword token">const</span> origin <span class="operator token">=</span> md<span class="punctuation token">.</span>renderer<span class="punctuation token">.</span>rules<span class="punctuation token">.</span><span class="function token">fence</span><span class="punctuation token">.</span><span class="function token">bind</span><span class="punctuation token">(</span>md<span class="punctuation token">.</span>renderer<span class="punctuation token">.</span>rules<span class="punctuation token">)</span><br>        md<span class="punctuation token">.</span>renderer<span class="punctuation token">.</span>rules<span class="punctuation token">.</span><span class="function function-variable token">fence</span> <span class="operator token">=</span> <span class="punctuation token">(</span><span class="parameter token">tokens<span class="punctuation token">,</span> idx<span class="punctuation token">,</span> <span class="operator token">...</span>args</span><span class="punctuation token">)</span> <span class="operator token">=></span> <span class="punctuation token">{</span><br>          <span class="keyword token">const</span> token <span class="operator token">=</span> tokens<span class="punctuation token">[</span>idx<span class="punctuation token">]</span><br>          <span class="keyword token">if</span> <span class="punctuation token">(</span>token<span class="punctuation token">.</span>info <span class="operator token">===</span> <span class="string token">'mermaid'</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>            <span class="keyword token">return</span> <span class="template-string token"><span class="string template-punctuation token">`</span><span class="string token">&lt;pre class="mermaid"></span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>token<span class="punctuation token">.</span>content<span class="punctuation token">.</span><span class="function token">trim</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">&lt;/pre></span><span class="string template-punctuation token">`</span></span><br>          <span class="punctuation token">}</span><br>          <span class="keyword token">return</span> <span class="function token">origin</span><span class="punctuation token">(</span>tokens<span class="punctuation token">,</span> idx<span class="punctuation token">,</span> <span class="operator token">...</span>args<span class="punctuation token">)</span><br>        <span class="punctuation token">}</span><br>      <span class="punctuation token">}</span><span class="punctuation token">)</span><br>  <span class="punctuation token">)</span><br><br>  <span class="comment token">// Filter that keeps items that have the same `data.locale` as</span><br>  <span class="comment token">// `locale`. If `locale` is falsy, it is fetched in the current context.</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addFilter</span><span class="punctuation token">(</span><span class="string token">'samelocale'</span><span class="punctuation token">,</span> <span class="keyword token">function</span> <span class="punctuation token">(</span><span class="parameter token">collection<span class="punctuation token">,</span> locale</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    locale <span class="operator token">=</span> locale <span class="operator token">||</span> <span class="keyword token">this</span><span class="punctuation token">.</span>ctx<span class="punctuation token">.</span>locale <span class="operator token">||</span> locales<span class="punctuation token">.</span>index<br>    <span class="keyword token">return</span> collection<span class="punctuation token">.</span><span class="function token">filter</span><span class="punctuation token">(</span><span class="punctuation token">(</span><span class="parameter token">item</span><span class="punctuation token">)</span> <span class="operator token">=></span> <span class="punctuation token">{</span><br>      <span class="keyword token">return</span> item<span class="punctuation token">.</span>data<span class="punctuation token">.</span>locale <span class="operator token">===</span> locale<br>    <span class="punctuation token">}</span><span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><span class="punctuation token">)</span><br><br>  <span class="comment token">// Filter that keeps items that are translations of `page`.</span><br>  <span class="comment token">// If `page` is falsy, it is fetched in the current context.</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addFilter</span><span class="punctuation token">(</span><span class="string token">'samepage'</span><span class="punctuation token">,</span> <span class="keyword token">function</span> <span class="punctuation token">(</span><span class="parameter token">collection<span class="punctuation token">,</span> page</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="operator token">!</span>page<span class="punctuation token">)</span> <span class="punctuation token">{</span><br>      <span class="keyword token">const</span> pathInfo <span class="operator token">=</span> path<span class="punctuation token">.</span><span class="function token">parse</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>ctx<span class="punctuation token">.</span>page<span class="punctuation token">.</span>filePathStem<span class="punctuation token">)</span><br>      page <span class="operator token">=</span><br>        pathInfo<span class="punctuation token">.</span>base <span class="keyword token">in</span> locales <span class="operator token">?</span> pathInfo<span class="punctuation token">.</span>dir <span class="operator token">:</span> <span class="keyword token">this</span><span class="punctuation token">.</span>ctx<span class="punctuation token">.</span>page<span class="punctuation token">.</span>filePathStem<br>    <span class="punctuation token">}</span><br>    <span class="keyword token">return</span> collection<span class="punctuation token">.</span><span class="function token">filter</span><span class="punctuation token">(</span><span class="punctuation token">(</span><span class="parameter token">item</span><span class="punctuation token">)</span> <span class="operator token">=></span> <span class="punctuation token">{</span><br>      <span class="keyword token">const</span> pathInfo <span class="operator token">=</span> path<span class="punctuation token">.</span><span class="function token">parse</span><span class="punctuation token">(</span>item<span class="punctuation token">.</span>filePathStem<span class="punctuation token">)</span><br>      <span class="keyword token">return</span> <span class="punctuation token">(</span><br>        <span class="punctuation token">(</span>pathInfo<span class="punctuation token">.</span>base <span class="keyword token">in</span> locales<br>          <span class="operator token">?</span> pathInfo<span class="punctuation token">.</span>dir<br>          <span class="operator token">:</span> <span class="keyword token">this</span><span class="punctuation token">.</span>ctx<span class="punctuation token">.</span>page<span class="punctuation token">.</span>filePathStem<span class="punctuation token">)</span> <span class="operator token">===</span> page<br>      <span class="punctuation token">)</span><br>    <span class="punctuation token">}</span><span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><span class="punctuation token">)</span><br><br>  <span class="comment token">// Append locale identifier at given url</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addFilter</span><span class="punctuation token">(</span><span class="string token">'localizeurl'</span><span class="punctuation token">,</span> <span class="keyword token">function</span> <span class="punctuation token">(</span><span class="parameter token">url<span class="punctuation token">,</span> locale</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    locale <span class="operator token">=</span> locale <span class="operator token">||</span> <span class="keyword token">this</span><span class="punctuation token">.</span>ctx<span class="punctuation token">.</span>locale <span class="operator token">||</span> locales<span class="punctuation token">.</span>index<br>    <span class="keyword token">const</span> pathInfo <span class="operator token">=</span> path<span class="punctuation token">.</span><span class="function token">parse</span><span class="punctuation token">(</span>url<span class="punctuation token">)</span><br>    <span class="comment token">// (/fr)? + /path/to + (/non-locale-file-name)? + /</span><br>    <span class="keyword token">return</span> eleventyConfig<span class="punctuation token">.</span><span class="function token">getFilter</span><span class="punctuation token">(</span><span class="string token">'url'</span><span class="punctuation token">)</span><span class="punctuation token">(</span><br>      <span class="template-string token"><span class="string template-punctuation token">`</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>locale <span class="operator token">===</span> locales<span class="punctuation token">.</span>index <span class="operator token">?</span> <span class="string token">''</span> <span class="operator token">:</span> <span class="template-string token"><span class="string template-punctuation token">`</span><span class="string token">/</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>locale<span class="interpolation-punctuation punctuation token">}</span></span><span class="string template-punctuation token">`</span></span><span class="interpolation-punctuation punctuation token">}</span></span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span><br>        pathInfo<span class="punctuation token">.</span>dir <span class="operator token">===</span> <span class="string token">'/'</span> <span class="operator token">?</span> <span class="string token">''</span> <span class="operator token">:</span> pathInfo<span class="punctuation token">.</span>dir<br>      <span class="interpolation-punctuation punctuation token">}</span></span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>pathInfo<span class="punctuation token">.</span>base <span class="keyword token">in</span> locales <span class="operator token">?</span> <span class="string token">''</span> <span class="operator token">:</span> <span class="template-string token"><span class="string template-punctuation token">`</span><span class="string token">/</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>pathInfo<span class="punctuation token">.</span>base<span class="interpolation-punctuation punctuation token">}</span></span><span class="string template-punctuation token">`</span></span><span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">/</span><span class="string template-punctuation token">`</span></span><br>    <span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><span class="punctuation token">)</span><br><br>  <span class="comment token">// Sort locales in alphabetical order</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addFilter</span><span class="punctuation token">(</span><span class="string token">'sortbylocale'</span><span class="punctuation token">,</span> <span class="keyword token">function</span> <span class="punctuation token">(</span><span class="parameter token">collection</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    <span class="keyword token">return</span> <span class="punctuation token">[</span><span class="operator token">...</span>collection<span class="punctuation token">]</span><span class="punctuation token">.</span><span class="function token">sort</span><span class="punctuation token">(</span><span class="punctuation token">(</span><span class="parameter token">a<span class="punctuation token">,</span> b</span><span class="punctuation token">)</span> <span class="operator token">=></span><br>      a<span class="punctuation token">.</span>data<span class="punctuation token">.</span>locale<span class="punctuation token">.</span><span class="function token">localeCompare</span><span class="punctuation token">(</span>b<span class="punctuation token">.</span>data<span class="punctuation token">.</span>locale<span class="punctuation token">)</span><br>    <span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><span class="punctuation token">)</span><br><br>  <span class="comment token">// Cut slash-separated tags</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addFilter</span><span class="punctuation token">(</span><span class="string token">'subtags'</span><span class="punctuation token">,</span> <span class="keyword token">function</span> <span class="punctuation token">(</span><span class="parameter token">tags<span class="punctuation token">,</span> category</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    <span class="keyword token">const</span> length <span class="operator token">=</span> category<span class="punctuation token">.</span>length <span class="operator token">+</span> <span class="number token">1</span><br>    <span class="keyword token">return</span> tags<br>      <span class="punctuation token">.</span><span class="function token">filter</span><span class="punctuation token">(</span><span class="punctuation token">(</span><span class="parameter token">tag</span><span class="punctuation token">)</span> <span class="operator token">=></span> tag<span class="punctuation token">.</span><span class="function token">startsWith</span><span class="punctuation token">(</span>category <span class="operator token">+</span> <span class="string token">'/'</span><span class="punctuation token">,</span> <span class="number token">0</span><span class="punctuation token">)</span><span class="punctuation token">)</span><br>      <span class="punctuation token">.</span><span class="function token">map</span><span class="punctuation token">(</span><span class="punctuation token">(</span><span class="parameter token">tag</span><span class="punctuation token">)</span> <span class="operator token">=></span> tag<span class="punctuation token">.</span><span class="function token">slice</span><span class="punctuation token">(</span>Math<span class="punctuation token">.</span><span class="function token">max</span><span class="punctuation token">(</span><span class="number token">0</span><span class="punctuation token">,</span> length<span class="punctuation token">)</span><span class="punctuation token">)</span><span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><span class="punctuation token">)</span><br><br>  <span class="comment token">// Translate the string given with translations found in `_data/translations`</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addFilter</span><span class="punctuation token">(</span><span class="string token">'t'</span><span class="punctuation token">,</span> <span class="keyword token">function</span> <span class="punctuation token">(</span><span class="parameter token">string<span class="punctuation token">,</span> locale</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    locale <span class="operator token">=</span> locale <span class="operator token">||</span> <span class="keyword token">this</span><span class="punctuation token">.</span>ctx<span class="punctuation token">.</span>locale <span class="operator token">||</span> locales<span class="punctuation token">.</span>index<br>    <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="operator token">!</span>translations<span class="punctuation token">.</span><span class="function token">has</span><span class="punctuation token">(</span>locale<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>      <span class="keyword token">throw</span> <span class="keyword token">new</span> <span class="class-name token">Error</span><span class="punctuation token">(</span><span class="template-string token"><span class="string template-punctuation token">`</span><span class="string token">Unknown locale "</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>locale<span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">"</span><span class="string template-punctuation token">`</span></span><span class="punctuation token">)</span><br>    <span class="punctuation token">}</span><br>    <span class="keyword token">const</span> strings <span class="operator token">=</span> translations<span class="punctuation token">.</span><span class="function token">get</span><span class="punctuation token">(</span>locale<span class="punctuation token">)</span><br>    <span class="keyword token">if</span> <span class="punctuation token">(</span>strings<span class="punctuation token">.</span><span class="function token">has</span><span class="punctuation token">(</span>string<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>      <span class="keyword token">return</span> strings<span class="punctuation token">.</span><span class="function token">get</span><span class="punctuation token">(</span>string<span class="punctuation token">)</span><br>    <span class="punctuation token">}</span><br>    <span class="keyword token">const</span> fallbackStrings <span class="operator token">=</span> translations<span class="punctuation token">.</span><span class="function token">get</span><span class="punctuation token">(</span>locales<span class="punctuation token">.</span>index<span class="punctuation token">)</span><br>    <span class="keyword token">if</span> <span class="punctuation token">(</span>fallbackStrings<span class="punctuation token">.</span><span class="function token">has</span><span class="punctuation token">(</span>string<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>      <span class="keyword token">return</span> fallbackStrings<span class="punctuation token">.</span><span class="function token">get</span><span class="punctuation token">(</span>string<span class="punctuation token">)</span><br>    <span class="punctuation token">}</span><br>    <span class="keyword token">throw</span> <span class="keyword token">new</span> <span class="class-name token">Error</span><span class="punctuation token">(</span><br>      <span class="template-string token"><span class="string template-punctuation token">`</span><span class="string token">Cannot find a suitable transation for the string "</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>string<span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">" for locale "</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>locale<span class="interpolation-punctuation punctuation token">}</span></span><span class="string token">"</span><span class="string template-punctuation token">`</span></span><br>    <span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><span class="punctuation token">)</span><br><br>  <span class="comment token">// Translate the string given with translations found in `_data/translations`</span><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">addFilter</span><span class="punctuation token">(</span><br>    <span class="string token">'dateformat'</span><span class="punctuation token">,</span><br>    <span class="keyword token">function</span> <span class="punctuation token">(</span><span class="parameter token">date<span class="punctuation token">,</span> locale<span class="punctuation token">,</span> format <span class="operator token">=</span> DateTime<span class="punctuation token">.</span><span class="constant token">DATE_FULL</span></span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>      locale <span class="operator token">=</span> locale <span class="operator token">||</span> <span class="keyword token">this</span><span class="punctuation token">.</span>ctx<span class="punctuation token">.</span>locale <span class="operator token">||</span> locales<span class="punctuation token">.</span>index<br>      <span class="keyword token">return</span> DateTime<span class="punctuation token">.</span><span class="function token">fromJSDate</span><span class="punctuation token">(</span>date<span class="punctuation token">)</span><span class="punctuation token">.</span><span class="function token">setLocale</span><span class="punctuation token">(</span>locale<span class="punctuation token">)</span><span class="punctuation token">.</span><span class="function token">toLocaleString</span><span class="punctuation token">(</span>format<span class="punctuation token">)</span><br>    <span class="punctuation token">}</span><br>  <span class="punctuation token">)</span><br><br>  <span class="comment token">// Articles in a given language</span><br>  <span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">const</span> locale <span class="keyword token">of</span> Object<span class="punctuation token">.</span><span class="function token">keys</span><span class="punctuation token">(</span>locales<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>    <span class="keyword token">if</span> <span class="punctuation token">(</span>locale <span class="operator token">===</span> <span class="string token">'index'</span><span class="punctuation token">)</span> <span class="keyword token">continue</span><br>    eleventyConfig<span class="punctuation token">.</span><span class="function token">addCollection</span><span class="punctuation token">(</span><span class="template-string token"><span class="string template-punctuation token">`</span><span class="string token">post/</span><span class="interpolation token"><span class="interpolation-punctuation punctuation token">${</span>locale<span class="interpolation-punctuation punctuation token">}</span></span><span class="string template-punctuation token">`</span></span><span class="punctuation token">,</span> <span class="keyword token">function</span> <span class="punctuation token">(</span><span class="parameter token">collectionApi</span><span class="punctuation token">)</span> <span class="punctuation token">{</span><br>      <span class="keyword token">return</span> eleventyConfig<span class="punctuation token">.</span><span class="function token">getFilter</span><span class="punctuation token">(</span><span class="string token">'samelocale'</span><span class="punctuation token">)</span><span class="punctuation token">(</span><br>        collectionApi<span class="punctuation token">.</span><span class="function token">getFilteredByTag</span><span class="punctuation token">(</span><span class="string token">'post'</span><span class="punctuation token">)</span><span class="punctuation token">.</span><span class="function token">reverse</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">,</span><br>        locale<br>      <span class="punctuation token">)</span><br>    <span class="punctuation token">}</span><span class="punctuation token">)</span><br>  <span class="punctuation token">}</span><br><br>  eleventyConfig<span class="punctuation token">.</span><span class="function token">setBrowserSyncConfig</span><span class="punctuation token">(</span><span class="punctuation token">{</span><br>    watch<span class="operator token">:</span> <span class="boolean token">true</span><span class="punctuation token">,</span><br>    server<span class="operator token">:</span> <span class="string token">'.dist'</span><span class="punctuation token">,</span><br>  <span class="punctuation token">}</span><span class="punctuation token">)</span><br><br>  <span class="keyword token">return</span> <span class="punctuation token">{</span><br>    dir<span class="operator token">:</span> <span class="punctuation token">{</span><br>      input<span class="operator token">:</span> <span class="string token">'pages'</span><span class="punctuation token">,</span><br>      output<span class="operator token">:</span> <span class="string token">'.pre-dist'</span><span class="punctuation token">,</span><br>    <span class="punctuation token">}</span><span class="punctuation token">,</span><br>    markdownTemplateEngine<span class="operator token">:</span> <span class="string token">'njk'</span><span class="punctuation token">,</span><br>  <span class="punctuation token">}</span><br><span class="punctuation token">}</span></code></pre> <pre class="language-css"><code class="language-css"><span class="comment token">/**<br> * Correct the font size and margin on `h1` elements within `section` and<br> * `article` contexts in Chrome, Firefox, and Safari.<br> */</span><br><br><span class="selector token">h1</span> <span class="punctuation token">{</span><br>  <span class="property token">font-size</span><span class="punctuation token">:</span> 2em<span class="punctuation token">;</span><br>  <span class="property token">margin</span><span class="punctuation token">:</span> 0.67em 0<span class="punctuation token">;</span><br><span class="punctuation token">}</span></code></pre> <pre class="language-html"><code class="language-html"><span class="doctype token"><span class="punctuation token">&lt;!</span><span class="doctype-tag token">DOCTYPE</span> <span class="name token">html</span><span class="punctuation token">></span></span><br><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>html</span> <span class="attr-name token">lang</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>en<span class="punctuation token">"</span></span><span class="punctuation token">></span></span><br>  <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>head</span><span class="punctuation token">></span></span><br>    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>meta</span> <span class="attr-name token">charset</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>utf-8<span class="punctuation token">"</span></span> <span class="punctuation token">/></span></span><br>    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>meta</span> <span class="attr-name token">name</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>viewport<span class="punctuation token">"</span></span> <span class="attr-name token">content</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>width=device-width, initial-scale=1.0<span class="punctuation token">"</span></span> <span class="punctuation token">/></span></span><br>    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>title</span><span class="punctuation token">></span></span>Document<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>title</span><span class="punctuation token">></span></span><br>    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>link</span> <span class="attr-name token">rel</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>stylesheet<span class="punctuation token">"</span></span> <span class="attr-name token">href</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span><span class="punctuation token">"</span></span> <span class="punctuation token">/></span></span><br>    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>link</span> <span class="attr-name token">rel</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>shortcut icon<span class="punctuation token">"</span></span> <span class="attr-name token">href</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>~/static/favicon.ico<span class="punctuation token">"</span></span> <span class="attr-name token">type</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>image/x-icon<span class="punctuation token">"</span></span> <span class="punctuation token">/></span></span><br>    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>link</span> <span class="attr-name token">rel</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>manifest<span class="punctuation token">"</span></span> <span class="attr-name token">href</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>~/assets/app.webmanifest<span class="punctuation token">"</span></span> <span class="punctuation token">/></span></span><br>    <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>meta</span> <span class="attr-name token">property</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>og:image<span class="punctuation token">"</span></span> <span class="attr-name token">content</span><span class="attr-value token"><span class="attr-equals punctuation token">=</span><span class="punctuation token">"</span>~/resources/portfolio.png<span class="punctuation token">"</span></span> <span class="punctuation token">/></span></span><br>  <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>head</span><span class="punctuation token">></span></span><br><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>html</span><span class="punctuation token">></span></span></code></pre> <hr> </div> <script src="https://utteranc.es/client.js" repo="GauBen/gauben.github.io" issue-term="pathname" label="comment thread" theme="github-light" crossorigin async></script> <script>window.addEventListener("load",(()=>{let e=!1;const t=document.querySelector("iframe.utterances-frame");document.querySelector("#dark-toggle").addEventListener("click",(()=>{t.contentWindow.postMessage({type:"set-theme",theme:e?"github-light":"github-dark"},"https://utteranc.es"),e=!e}))}));</script> <footer class="_beautiful-links page-footer"> <p>This page is available in: <strong>English</strong>.</p> <p>2020 – Gautier Ben Aïm – CC BY 4.0</p> <p>I love minimalism.</p> <p> <button id="dark-toggle" class="ghost-button" onclick="this.innerText = document.body.classList.toggle('_dark') ? '🌞' : '🌙'"> 🌙 </button> </p> </footer> </body></html>